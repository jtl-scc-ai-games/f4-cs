<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>å…¬æ°‘æ¬Šåˆ©èˆ‡ç¾©å‹™ï¼šæ·±åº¦æ•™å­¸ç‰ˆ</title>
    <style>
        :root {
            --primary: #2c3e50; --success: #27ae60; --danger: #e74c3c;
            --warning: #f1c40f; --info: #3498db; --bg: #f4f7f6;
        }
        body { font-family: "Microsoft JhengHei", sans-serif; background: var(--bg); margin: 0; display: flex; overflow: hidden; height: 100vh; }
        
        /* å´é‚Šæ¬„ */
        #sidebar { 
            width: 320px; background: var(--primary); color: white; padding: 15px; 
            display: flex; flex-direction: column; box-shadow: 3px 0 15px rgba(0,0,0,0.3); 
            z-index: 110; 
        }
        .team-card { background: rgba(255,255,255,0.1); padding: 10px; margin-bottom: 8px; border-radius: 10px; border-left: 6px solid transparent; transition: 0.3s; }
        .team-card.active { border-left-color: var(--warning); background: rgba(255,255,255,0.25); box-shadow: 0 0 15px var(--warning); }
        .score-row { display: flex; justify-content: space-between; align-items: center; }
        .score-num { font-size: 24px; color: var(--warning); font-weight: bold; }
        .manual-btn { background: var(--success); color: white; border: none; padding: 6px 12px; border-radius: 5px; cursor: pointer; font-weight: bold; }

        /* æ£‹ç›¤ */
        #main-content { flex-grow: 1; padding: 20px; display: flex; flex-direction: column; align-items: center; position: relative; }
        #board { display: grid; grid-template-columns: repeat(10, 1fr); gap: 8px; background: #bdc3c7; padding: 10px; border-radius: 15px; width: 100%; max-width: 950px; }
        .cell { height: 75px; background: white; border-radius: 8px; position: relative; display: flex; align-items: center; justify-content: center; font-weight: bold; border: 1px solid #95a5a6; }
        .cell.event-up { background: #e8f5e9; border: 2px solid var(--success); }
        .cell.event-down { background: #ffebee; border: 2px solid var(--danger); }
        .cell.completed { filter: grayscale(1); opacity: 0.4; }

        /* æ£‹å­ï¼šå¸¶æ•¸å­— */
        .pawn-container { position: absolute; bottom: 5px; width: 100%; display: flex; flex-wrap: wrap; justify-content: center; gap: 2px; }
        .pawn { 
            width: 22px; height: 22px; border-radius: 50%; border: 2px solid white; 
            box-shadow: 0 2px 4px rgba(0,0,0,0.3); display: flex; align-items: center; 
            justify-content: center; font-size: 14px; color: white; font-weight: 900;
        }

        /* å½ˆçª— */
        #overlay { display: none; position: fixed; top: 0; left: 320px; right: 0; bottom: 0; background: rgba(0,0,0,0.85); z-index: 100; }
        #modal { 
            display: none; position: fixed; top: 50%; left: calc(50% + 160px); 
            transform: translate(-50%, -50%); width: 85%; max-width: 850px; 
            background: white; padding: 35px; border-radius: 30px; z-index: 105; 
            text-align: center; box-shadow: 0 10px 50px rgba(0,0,0,0.6); 
        }
        #m-desc { font-size: 38px; line-height: 1.3; color: #222; font-weight: 900; margin-bottom: 20px; }
        .ans-box { 
            display: none; margin: 15px 0; padding: 20px; 
            background: #fff9c4; border: 4px dashed #fbc02d; border-radius: 15px; 
        }
        .ans-text { font-size: 32px; color: #d32f2f; font-weight: bold; display: block; margin-bottom: 10px; }
        .logic-text { font-size: 24px; color: #2c3e50; line-height: 1.4; display: block; background: white; padding: 10px; border-radius: 10px; }

        /* éŠæˆ²ç¸½çµé¢æ¿ */
        #summary-overlay { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background:white; z-index: 200; overflow-y: auto; padding: 40px; }
        .summary-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .summary-table th, .summary-table td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        .summary-table th { background: var(--primary); color: white; }
        
        .action-btn { padding: 15px; width: 100%; border-radius: 12px; border: none; font-size: 24px; font-weight: bold; cursor: pointer; margin-top: 10px; }
        #dice-box { background: rgba(0,0,0,0.2); padding: 10px; border-radius: 15px; text-align: center; margin-top: auto; }
        #dice { font-size: 50px; background: white; width: 80px; height: 80px; line-height: 80px; margin: 10px auto; border-radius: 10px; color: #333; cursor: pointer; font-weight: bold; }
        .summary-btn { background: var(--info); color: white; border: none; padding: 10px; border-radius: 8px; cursor: pointer; margin-top: 10px; font-weight: bold; }
    </style>
</head>
<body>

<div id="sidebar">
    <h2 style="text-align:center; margin-bottom:10px;">ğŸ† ç©åˆ†æ¦œ</h2>
    <div id="teams-list"></div>
    <button class="summary-btn" onclick="showSummary()">ğŸ“Š éŠæˆ²ç¸½çµ (æº«ç¿’æ¸…å–®)</button>
    <div id="dice-box">
        <p id="turn-txt" style="color:var(--warning); font-weight: bold;">æº–å‚™é–‹å§‹</p>
        <div id="dice" onclick="roll()">ğŸ²</div>
        <p id="roll-status">é»æ“Šéª°å­</p>
    </div>
</div>

<div id="main-content">
    <h1 style="color:var(--primary); margin: 0 0 10px 0;">æ¬Šåˆ©èˆ‡ç¾©å‹™äº’å‹•æŒ‘æˆ°è³½</h1>
    <div id="board"></div>
</div>

<div id="overlay"></div>
<div id="modal">
    <div id="m-desc"></div>
    <div class="ans-box" id="m-ans">
        <span class="ans-text" id="m-ans-title"></span>
        <span class="logic-text" id="m-logic"></span>
    </div>
    <button class="action-btn" style="background:var(--warning)" id="btn-show" onclick="showAns()">é¡¯ç¤ºè§£èªª</button>
    <button class="action-btn" style="background:var(--primary); color:white; display:none;" id="btn-move" onclick="proceed()">åŸ·è¡Œç§»å‹•ä¸¦æ›çµ„</button>
</div>

<div id="summary-overlay">
    <button onclick="document.getElementById('summary-overlay').style.display='none'" style="float:right; padding:10px; background:var(--danger); color:white; border:none; border-radius:5px; cursor:pointer;">é—œé–‰ç¸½çµ</button>
    <h1>ğŸ“‹ èª²å ‚äº‹ä»¶ç¸½çµèˆ‡è§£èªª</h1>
    <table class="summary-table" id="summary-content">
        <thead>
            <tr>
                <th>ç·¨è™Ÿ</th>
                <th>äº‹ä»¶å…§å®¹</th>
                <th>æ³•å¾‹åˆ¤å®š</th>
                <th>è§£èªªé‚è¼¯</th>
                <th>çµæœ</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<script>
    const teamColors = ["#e74c3c", "#3498db", "#2ecc71", "#f1c40f", "#9b59b6", "#e67e22"];
    let teamPos = [1, 1, 1, 1, 1, 1];
    let teamScores = [0, 0, 0, 0, 0, 0];
    let currentTeam = 0;
    let isMoving = false;
    let jumpQueued = 0;
    let eventCount = 0;
    let completedSquares = new Set();

    const events = {
        3: { move: 2, desc: "å› å°å…¬å…±æ”¿ç­–ä¸æ»¿ï¼Œå‘ç”³è¨´å°ˆå“¡å…¬ç½²æäº¤æ­£å¼æŠ•è¨´ã€‚", ans: "ç­”æ¡ˆï¹•å¸æ³•æ¬Šåˆ© (ç”³è¨´æ¬Šã€æå‡ºè¨´è¨Ÿ)", logic: "åˆ¤æ–·ï¼šæœ‰æ•ˆè¡Œä½¿æ³•å®šç”³è¨´æ¬Šåˆ©ã€‚é€éåˆæ³•é€”å¾‘è¡¨é”ä¸æ»¿ï¼Œç²å‡†çå‹µå‰é€²ã€‚" },
        6: { move: 2, desc: "ç©æ¥µåƒèˆ‡å€è­°æœƒçš„ã€Œå…¬çœ¾è«®è©¢æœƒã€ï¼Œç™¼è¡¨å»ºè¨­æ€§æ„è¦‹ã€‚", ans: "ç­”æ¡ˆï¹•ç¾©å‹™ (ç›£å¯Ÿæ”¿åºœæ–½æ”¿)", logic: "åˆ¤æ–·ï¼šå±¥è¡Œå…¬æ°‘ç¾©å‹™ã€‚ç©æ¥µåƒèˆ‡å…¬å…±äº‹å‹™æœ‰åŠ©æ”¿åºœæ”¹è‰¯æ–½æ”¿ï¼Œç²å‡†å‰é€²ã€‚" },
        8: { move: 3, desc: "åœ¨å€‹äººç¤¾äº¤åª’é«”ä¸Šç™¼è¡¨å°æ™‚äº‹çš„åˆç†æ‰¹è©•ï¼Œè¨€è©è¬¹æ…ã€‚", ans: "ç­”æ¡ˆï¹•æ”¿æ²»æ¬Šåˆ© (è¨€è«–è‡ªç”±)", logic: "åˆ¤æ–·ï¼šåœ¨åˆæ³•ç¯„åœå…§äº«ç”¨è¨€è«–è‡ªç”±ã€‚ç†æ€§çš„æ‰¹è©•å—æ³•å¾‹ä¿éšœï¼Œçå‹µå‰é€²ã€‚" },
        11: { move: 2, desc: "åœ¨æœ€è¿‘çš„é¸èˆ‰ä¸­å·²ç™»è¨˜ç‚ºé¸æ°‘ä¸¦å®ŒæˆæŠ•ç¥¨ã€‚", ans: "ç­”æ¡ˆï¹•æ”¿æ²»æ¬Šåˆ© (é¸èˆ‰æ¬Š)", logic: "åˆ¤æ–·ï¼šè¡Œä½¿å…¬æ°‘ç¥è–çš„é¸èˆ‰æ¬Šã€‚åƒèˆ‡æ°‘ä¸»ç¨‹åºæ˜¯æ¬Šåˆ©çš„é«”ç¾ï¼Œç²å‡†å‰é€²ã€‚" },
        13: { move: 2, desc: "ä½œç‚ºè¢«å‘Šï¼Œç²æ³•åº­å‡†è¨±ä¿é‡‹ä¸¦å¦‚æœŸå‡ºåº­æ‡‰è¨Šã€‚", ans: "ç­”æ¡ˆï¹•ç¾©å‹™ (éµå®ˆæ³•å¾‹ã€å°Šé‡å…¬å¹³å¯©è¨Š)", logic: "åˆ¤æ–·ï¼šå±¥è¡Œæ³•å¾‹ç¾©å‹™ã€‚é…åˆå¸æ³•ç¨‹åºæ˜¯æ¯ä½å…¬æ°‘çš„è·è²¬ï¼Œçå‹µå‰é€²ã€‚" },
        16: { move: 3, desc: "æˆåŠŸç²å¾—ä¸€ä»½èˆ‡ä½ å°ˆæ¥­æŠ€èƒ½ç›¸é—œçš„æ–°å·¥ä½œã€‚", ans: "ç­”æ¡ˆï¹•ç¶“æ¿Ÿæ¬Šåˆ© (è·æ¥­é¸æ“‡è‡ªç”±)", logic: "åˆ¤æ–·ï¼šäº«ç”¨å‹å‹•åŠè·æ¥­é¸æ“‡æ¬Šã€‚å€‹äººç™¼å±•å—æ¬Šåˆ©ä¿éšœï¼Œçå‹µå‰é€²ã€‚" },
        18: { move: 2, desc: "èˆ‡å·¥æœƒæˆå“¡ä¸€èµ·å‘åƒ±ä¸»çˆ­å–æ›´å¥½çš„å‹å·¥æ¬Šç›Šã€‚", ans: "ç­”æ¡ˆï¹•æ”¿æ²»æ¬Šåˆ© (çµ„ç¹”å’ŒåƒåŠ å·¥æœƒ)", logic: "åˆ¤æ–·ï¼šäº«ç”¨é›†é«”è«‡åˆ¤èˆ‡çµç¤¾æ¬Šåˆ©ã€‚åˆæ³•ç¶­è­·åƒ±å“¡æ¬Šç›Šå—ä¿éšœï¼Œçå‹µå‰é€²ã€‚" },
        20: { move: 2, desc: "å‘æ”¿åºœæäº¤äº†ä¸€ä»½æœ‰å‰µæ„çš„åŸå¸‚è¦åŠƒå»ºè­°æ›¸ã€‚", ans: "ç­”æ¡ˆï¹•ç¾©å‹™ (åƒèˆ‡å…¬å…±äº‹å‹™ã€ç©æ¥µç™¼è¡¨æ„è¦‹)", logic: "åˆ¤æ–·ï¼šç©æ¥µå±¥è¡Œå…¬æ°‘åƒèˆ‡ç¾©å‹™ã€‚ç‚ºåŸå¸‚ç™¼å±•å‡ºè¬€ç»ç­–ï¼Œçå‹µå‰é€²ã€‚" },
        23: { move: 3, desc: "æ±ºå®šæ¬å®¶ï¼Œå¾æ¸¯å³¶é·å¾€æ–°ç•Œï¼Œä¸¦æˆåŠŸè¾¦ç†äº†æ‰‹çºŒã€‚", ans: "ç­”æ¡ˆï¹•å€‹äººæ¬Šåˆ© (é·å¾™è‡ªç”±)", logic: "åˆ¤æ–·ï¼šäº«ç”¨å±…æ‰€èˆ‡é·å¾™è‡ªç”±ã€‚å…¬æ°‘æœ‰æ¬Šæ±ºå®šè‡ªå·±çš„å±…ä½åœ°ï¼Œçå‹µå‰é€²ã€‚" },
        25: { move: 2, desc: "ä½ å°‡é–’ç½®çš„è³‡é‡‘å­˜å…¥éŠ€è¡Œæˆ–é€²è¡Œåˆæ³•çš„æŠ•è³‡ï¼Œç²å¾—å›å ±ã€‚", ans: "ç­”æ¡ˆï¹•ç¶“æ¿Ÿæ¬Šåˆ© (ç§æœ‰è²¡ç”¢æ¬Š)", logic: "åˆ¤æ–·ï¼šäº«ç”¨è²¡ç”¢è™•ç½®æ¬Šã€‚åˆæ³•çš„ç¶“æ¿Ÿæ´»å‹•èˆ‡è²¡ç”¢å¢å€¼å—ä¿è­·ï¼Œçå‹µå‰é€²ã€‚" },
        27: { move: 2, desc: "æˆåŠŸèˆ‡ä¼´ä¾¶åœ¨é¦™æ¸¯è¨»å†Šçµå©šã€‚", ans: "ç­”æ¡ˆï¹•å€‹äººæ¬Šåˆ© (å©šå§»è‡ªç”±)", logic: "åˆ¤æ–·ï¼šäº«ç”¨å©šå§»èˆ‡å»ºç«‹å®¶åº­çš„æ¬Šåˆ©ã€‚é€™æ˜¯æ³•å¾‹è³¦äºˆçš„åŸºæœ¬å€‹äººè‡ªç”±ï¼Œçå‹µå‰é€²ã€‚" },
        29: { move: 3, desc: "çµ„ç¹”ä¸€å€‹èˆˆè¶£å°çµ„ï¼ˆä¾‹å¦‚ï¼šè¡Œå±±éšŠã€è®€æ›¸æœƒï¼‰ä¸¦å‘æ”¿åºœè¨»å†Šã€‚", ans: "ç­”æ¡ˆï¹•æ”¿æ²»æ¬Šåˆ© (çµç¤¾è‡ªç”±)", logic: "åˆ¤æ–·ï¼šäº«ç”¨çµç¤¾è‡ªç”±ã€‚åˆæ³•çš„æ°‘é–“çµ„ç¹”æ´»å‹•å—æ³•å¾‹ä¿éšœï¼Œçå‹µå‰é€²ã€‚" },
        31: { move: 2, desc: "å› å¤±æ¥­è€Œå‘ç¤¾æœƒç¦åˆ©ç½²ç”³è«‹ç¶œåˆç¤¾æœƒä¿éšœæ´åŠ©ï¼ˆç¶œæ´ï¼‰ã€‚", ans: "ç­”æ¡ˆï¹•ç¤¾æœƒæ¬Šåˆ© (äº«æœ‰ç¦åˆ©)", logic: "åˆ¤æ–·ï¼šäº«ç”¨ç¤¾æœƒç¦åˆ©æ¬Šã€‚æ”¿åºœæœ‰è²¬ä»»ä¿éšœå…¬æ°‘çš„åŸºæœ¬ç”Ÿæ´»éœ€è¦ï¼Œçå‹µå‰é€²ã€‚" },
        33: { move: 2, desc: "æˆåŠŸç”³è«‹ä¸¦ç²å¾—äº†æ–°ç‰¹å€è­·ç…§æˆ–ç°½è­‰ï¼Œæº–å‚™å‡ºåœ‹æ—…éŠã€‚", ans: "ç­”æ¡ˆï¹•å€‹äººæ¬Šåˆ© (å‡ºå…¥å¢ƒè‡ªç”±)", logic: "åˆ¤æ–·ï¼šäº«ç”¨å‡ºå…¥å¢ƒæ¬Šåˆ©ã€‚æŒæœ‰æœ‰æ•ˆè­‰ä»¶è‡ªç”±å¾€è¿”å—ä¿éšœï¼Œçå‹µå‰é€²ã€‚" },
        36: { move: 3, desc: "æˆåŠŸå‘ä¸€é–“å‡ºç‰ˆç¤¾æäº¤ä½ å¯«çš„ä¸€æœ¬å°èªªï¼Œè¦æ±‚å‡ºç‰ˆã€‚", ans: "ç­”æ¡ˆï¹•æ–‡åŒ–æ¬Šåˆ© (å‡ºç‰ˆè‡ªç”± / å‰µä½œè‡ªç”±)", logic: "åˆ¤æ–·ï¼šäº«ç”¨æ–‡åŒ–èˆ‡å‰µä½œè‡ªç”±ã€‚çŸ¥è­˜ç”¢æ¬Šèˆ‡å‰µä½œç©ºé–“å—ä¿è­·ï¼Œçå‹µå‰é€²ã€‚" },
        38: { move: 2, desc: "å‘è¨˜è€…æä¾›è³‡æ–™ï¼Œæ­ç™¼äº†ä¸€å®—ä¼æ¥­çš„ä¸ç•¶è¡Œç‚ºã€‚", ans: "ç­”æ¡ˆï¹•æ”¿æ²»æ¬Šåˆ© (æ–°èè‡ªç”±)", logic: "åˆ¤æ–·ï¼šäº«ç”¨æ–°èåŠè¨€è«–è‡ªç”±ã€‚æ­ç™¼ç¤¾æœƒä¸å…¬ç¾©æ˜¯æ¬Šåˆ©çš„è¡Œä½¿ï¼Œçå‹µå‰é€²ã€‚" },
        40: { move: 3, desc: "ä½œç‚ºé¦™æ¸¯æ°¸ä¹…å±…æ°‘ï¼ŒæˆåŠŸåƒé¸å€è­°æœƒæˆ–ç«‹æ³•æœƒã€‚", ans: "ç­”æ¡ˆï¹•æ”¿æ²»æ¬Šåˆ© (è¢«é¸èˆ‰æ¬Š)", logic: "åˆ¤æ–·ï¼šäº«ç”¨è¢«é¸èˆ‰æ¬Šã€‚åƒèˆ‡ç®¡ç†åœ‹å®¶äº‹å‹™æ˜¯é«˜éšæ¬Šåˆ©çš„é«”ç¾ï¼Œçå‹µå‰é€²ã€‚" },
        43: { move: 2, desc: "åœ¨è­¦ç½²éŒ„å£ä¾›æ™‚ï¼Œä¸»å‹•è¦æ±‚èˆ‡ä½ çš„å¾‹å¸«æœƒé¢ã€‚", ans: "ç­”æ¡ˆï¹•å¸æ³•æ¬Šåˆ© (äº«æœ‰è¾¯è­·åŠç·˜é»˜æ¬Š)", logic: "åˆ¤æ–·ï¼šäº«ç”¨ç¨‹åºå…¬ç¾©ã€‚è¢«å‘Šäººåœ¨æ³•å¾‹é¢å‰æœ‰æ¬Šç²å¾—å°ˆæ¥­è¾¯è­·ï¼Œçå‹µå‰é€²ã€‚" },
        45: { move: 2, desc: "åœ¨æ¶‰åŠæ³•å¾‹å•é¡Œæ™‚ï¼ŒæˆåŠŸç²å¾—äº†ä¸€æ¬¡å…è²»çš„æ³•å¾‹è«®è©¢æœå‹™ã€‚", ans: "ç­”æ¡ˆï¹•å¸æ³•æ¬Šåˆ© (æ³•å¾‹æ´åŠ©æ¬Š)", logic: "åˆ¤æ–·ï¼šäº«ç”¨æ³•å¾‹æ´åŠ©æ¬Šã€‚ç¢ºä¿è²§å¯Œå…¬æ°‘åœ¨æ³•å¾‹é¢å‰éƒ½èƒ½ç²å¾—å¹«åŠ©ï¼Œçå‹µå‰é€²ã€‚" },
        47: { move: 3, desc: "ä½ æˆåŠŸå ±è®€äº†é¦™æ¸¯çš„å¤§å­¸ï¼Œè¡Œä½¿å—æ•™è‚²æ¬Šåˆ©ã€‚", ans: "ç­”æ¡ˆï¹•æ–‡åŒ–æ¬Šåˆ© (å­¸è¡“è‡ªç”±ã€æ¥å—æ•™è‚²æ¬Šåˆ©)", logic: "åˆ¤æ–·ï¼šäº«ç”¨æ•™è‚²æ¬Šã€‚å€‹äººé€éå­¸ç¿’æå‡è³ªç´ å—æ³•å¾‹ä¿éšœï¼Œçå‹µå‰é€²ã€‚" },
        // å¾Œé€€
        5: { move: -2, desc: "åœ¨é¢±é¢¨æˆ–ç·Šæ€¥æƒ…æ³ä¸‹ï¼Œä½ ç„¡è¦–æ”¿åºœç™¼å‡ºçš„å¼·åˆ¶æ’¤é›¢ä»¤ã€‚", ans: "ç­”æ¡ˆï¹•æ²’æœ‰éµå®ˆæ³•å¾‹ç¾©å‹™", logic: "è§£èªªï¼šé•åéµå®ˆæ³•å¾‹ç¾©å‹™ã€‚ç„¡è¦–ç·Šæ€¥å®‰å…¨æŒ‡ä»¤æœƒå±å®³ç¤¾æœƒèˆ‡å€‹äººï¼Œè™•åˆ†å¾Œé€€ã€‚" },
        10: { move: -2, desc: "åœ¨å…¬çœ¾é›†æœƒä¸­ï¼Œä½ çš„è·¯ç·šè¶…å‡ºäº†åŸå…ˆæ‰¹å‡†çš„é›†æœƒç¯„åœã€‚", ans: "ç­”æ¡ˆï¹• æ²’æœ‰éµå®ˆé›†æœƒè‡ªç”±çš„é™åˆ¶", logic: "è§£èªªï¼šé•åæ¬Šåˆ©è¡Œä½¿çš„ç•Œé™ã€‚è¡Œä½¿è‡ªç”±ä¸å¾—å¦¨ç¤™å…¬å…±ç§©åºï¼Œè™•åˆ†å¾Œé€€ã€‚" },
        15: { move: -3, desc: "ä½œç‚ºå…¬è·äººå“¡åŸ·è¡Œè·å‹™æ™‚ï¼Œå°ä»–äººä½¿ç”¨æš´åŠ›æˆ–æ–½åŠ æ®˜é…·å¼·é€¼è¢«å‘Šèªç½ªã€‚", ans: "ç­”æ¡ˆï¹•é•åç„¡ç½ªæ¨å®š", logic: "è§£èªªï¼šåš´é‡é•åäººæ¬Šç¾©å‹™ã€‚å…¬è·äººå“¡å¿…é ˆä¾æ³•åŸ·è¡Œè·å‹™ï¼Œä¾µçŠ¯äººæ¬Šéœ€è™•åˆ†å¾Œé€€ã€‚" },
        22: { move: -2, desc: "æœªç¶“æ³•åº­æˆæ¬Šï¼ŒåŸ·æ³•äººå“¡å¼·è¡Œé€²å…¥ä½ å®¶æœæŸ¥ã€‚", ans: "ç­”æ¡ˆï¹•é•åå€‹äººæ¬Šåˆ© (å±…ä½ä½æ‰€è‡ªç”±)", logic: "è§£èªªï¼šåŸ·æ³•ç¨‹åºå¤±ç•¶ï¼Œä¾µçŠ¯å±…ä½è‡ªç”±ã€‚é€™æ˜¯å°åŸºæœ¬æ¬Šåˆ©çš„ä¾µå®³ï¼Œè™•åˆ†å¾Œé€€ã€‚" },
        28: { move: -3, desc: "æœªç¶“åŒæ„ï¼Œéæ³•æˆªå–å’Œé–±è®€ä»–äººçš„ç§äººé›»éƒµæˆ–è¨Šæ¯ã€‚", ans: "ç­”æ¡ˆï¹•é•åå€‹äººæ¬Šåˆ© (é€šè¨Šè‡ªç”±)", logic: "è§£èªªï¼šé•åå°Šé‡ä»–äººéš±ç§çš„ç¾©å‹™ã€‚é€šè¨Šè‡ªç”±å—æ³•å¾‹åš´æ ¼ä¿è­·ï¼Œè™•åˆ†å¾Œé€€ã€‚" },
        35: { move: -2, desc: "åœ¨å…¬çœ¾å ´æ‰€æ•…æ„ç”¨å±éšªç‰©å“å‚·å®³ä»–äººã€‚", ans: "ç­”æ¡ˆï¹•é•åå€‹äººæ¬Šåˆ© (äººèº«å®‰å…¨/äººèº«è‡ªç”±)", logic: "è§£èªªï¼šé•åä¸å‚·å®³ä»–äººçš„æ³•å¾‹ç¾©å‹™ã€‚å±åŠä»–äººå®‰å…¨æ˜¯åš´é‡é•æ³•ï¼Œè™•åˆ†å¾Œé€€ã€‚" },
        42: { move: -3, desc: "å”åŠ©ä»–äººæ•£æ’­è™›å‡ã€Œææ€–ä¿¡æ¯ã€ã€‚", ans: "ç­”æ¡ˆï¹•é•åç¶­è­·åœ‹å®¶å®‰å…¨ç¾©å‹™", logic: "è§£èªªï¼šé•ååœ‹å®¶å®‰å…¨èˆ‡å…¬å…±å®‰å¯§ç¾©å‹™ã€‚æ•£æ’­è™›å‡å±éšªè¨Šæ¯éœ€è² æ³•å¾‹è²¬ä»»ï¼Œè™•åˆ†å¾Œé€€ã€‚" },
        49: { move: -2, desc: "æ‹’çµ•æ“”ä»»æ³•åº­é™ªå¯©å“¡ã€‚", ans: "ç­”æ¡ˆï¹• æœªæœ‰å±¥è¡Œé™ªå¯©ç¾©å‹™", logic: "è§£èªªï¼šé€ƒé¿å…¬æ°‘æ³•å®šç¾©å‹™ã€‚åƒèˆ‡å¸æ³•å¯©åˆ¤æ˜¯å…¬æ°‘è²¬ä»»ï¼Œæœªå±¥è¡Œè€…éœ€è™•åˆ†å¾Œé€€ã€‚" }
    };

    function init() {
        const b = document.getElementById('board');
        for (let i = 1; i <= 50; i++) {
            const c = document.createElement('div');
            c.className = 'cell'; c.id = `c-${i}`;
            c.innerHTML = `<span>${i}${i==1?'(èµ·é»)':i==50?'(çµ‚é»)':''}</span>`;
            if (events[i]) c.classList.add(events[i].move > 0 ? 'event-up' : 'event-down');
            const pc = document.createElement('div'); pc.className = 'pawn-container'; pc.id = `pc-${i}`;
            c.appendChild(pc); b.appendChild(c);
        }
        updateUI();
    }

    function updateUI() {
        document.querySelectorAll('.pawn').forEach(p => p.remove());
        teamPos.forEach((p, i) => {
            const div = document.createElement('div'); div.className = 'pawn';
            div.style.backgroundColor = teamColors[i];
            div.innerText = i + 1; // é¡¯ç¤ºçµ„åˆ¥æ•¸å­—
            document.getElementById(`pc-${p}`).appendChild(div);
        });
        const list = document.getElementById('teams-list');
        list.innerHTML = teamColors.map((col, i) => `
            <div class="team-card ${currentTeam === i ? 'active' : ''}" onclick="selectT(${i})">
                <div class="score-row">
                    <span>ç¬¬ ${i+1} çµ„</span>
                    <span class="score-num">${teamScores[i]}</span>
                </div>
                <div class="score-row" style="margin-top:5px">
                    <small>ä½ç½®: ${teamPos[i]}</small>
                    <button class="manual-btn" onclick="teamScores[${i}]+=10; updateUI(); event.stopPropagation();">ç­”å° +10</button>
                </div>
            </div>
        `).join('');
        document.getElementById('turn-txt').innerText = `è¼ªåˆ°ï¼šç¬¬ ${currentTeam + 1} çµ„`;
    }

    function selectT(i) { if(!isMoving) { currentTeam = i; updateUI(); } }

    async function roll() {
        if (isMoving) return;
        isMoving = true; eventCount = 0;
        const r = Math.floor(Math.random() * 6) + 1;
        document.getElementById('dice').innerText = r;
        document.getElementById('roll-status').innerText = `æ“²å‡º ${r} é»`;
        await animateMove(currentTeam, r);
    }

    async function animateMove(tIdx, steps) {
        let dir = steps > 0 ? 1 : -1;
        let s = Math.abs(steps);
        for (let i = 0; i < s; i++) {
            let next = teamPos[tIdx] + dir;
            if (next < 1) next = 1; if (next > 50) next = 50;
            teamPos[tIdx] = next;
            updateUI();
            await new Promise(res => setTimeout(res, 300));
            if (next === 50 && dir === 1) {
                teamScores[tIdx] += 50; updateUI();
                alert(`ğŸŠ ç¬¬ ${tIdx+1} çµ„åˆ°é”çµ‚é»ï¼è‡ªå‹•åŠ  50 åˆ†ï¼`);
                nextTurn(); return;
            }
        }
        checkEvent(teamPos[tIdx]);
    }

    function checkEvent(pos) {
        if (events[pos] && !completedSquares.has(pos) && eventCount < 2) {
            const ev = events[pos];
            document.getElementById('m-desc').innerText = ev.desc;
            document.getElementById('m-ans-title').innerText = ev.ans;
            document.getElementById('m-logic').innerText = ev.logic;
            document.getElementById('m-ans').style.display = 'none';
            document.getElementById('btn-show').style.display = 'block';
            document.getElementById('btn-move').style.display = 'none';
            document.getElementById('overlay').style.display = 'block';
            document.getElementById('modal').style.display = 'block';
            jumpQueued = ev.move;
            eventCount++;
            completedSquares.add(pos);
            document.getElementById(`c-${pos}`).classList.add('completed');
        } else {
            nextTurn();
        }
    }

    function showAns() {
        document.getElementById('m-ans').style.display = 'block';
        document.getElementById('btn-show').style.display = 'none';
        document.getElementById('btn-move').style.display = 'block';
    }

    async function proceed() {
        document.getElementById('overlay').style.display = 'none';
        document.getElementById('modal').style.display = 'none';
        if (jumpQueued !== 0) {
            let j = jumpQueued; jumpQueued = 0;
            await new Promise(r => setTimeout(r, 600));
            await animateMove(currentTeam, j);
        } else {
            nextTurn();
        }
    }

    function nextTurn() {
        isMoving = false;
        currentTeam = (currentTeam + 1) % 6;
        updateUI();
        document.getElementById('roll-status').innerText = `è«‹ç¬¬ ${currentTeam + 1} çµ„æ“²éª°å­`;
    }

    function showSummary() {
        const body = document.querySelector('#summary-content tbody');
        body.innerHTML = '';
        Object.keys(events).sort((a,b)=>a-b).forEach((key, index) => {
            const ev = events[key];
            const row = `<tr>
                <td>${index+1}</td>
                <td>${ev.desc}</td>
                <td style="color:var(--danger); font-weight:bold;">${ev.ans}</td>
                <td>${ev.logic}</td>
                <td style="color:${ev.move > 0 ? 'green' : 'red'}; font-weight:bold;">${ev.move > 0 ? 'å‰é€² '+ev.move : 'å¾Œé€€ '+Math.abs(ev.move)} æ ¼</td>
            </tr>`;
            body.innerHTML += row;
        });
        document.getElementById('summary-overlay').style.display = 'block';
    }

    init();
</script>
</body>
</html>